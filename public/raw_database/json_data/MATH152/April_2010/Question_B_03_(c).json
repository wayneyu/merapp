{
    "term": "April", 
    "question": "Question_B_03_(c)", 
    "course": "MATH152", 
    "statement": "A random walk problem with two states has a transition matrix\n\n\\begin{align*}P = \\left[\\begin{array}{cc} 1/3 & 1/4 \\\\ 2/3 & 3/4\\end{array}\\right]\\end{align*}\n\nc) Assume that the walker starts in state 1. Give an explicit formula\nthat only depends on $n$ for the probability it is in state 1 after $n$\ntime steps.", 
    "year": 2010, 
    "sols": [
        "We know that the probability vector after $n$ steps is determined by\nmultiplying the initial state by the matrix $P$, $n$times.\n\nWe begin by expressing the initial probability vector in terms of the\neigenvectors of $P$. i.e:\n\n\\begin{align*}\nc_{1}\\left[\\begin{array}{c} 1/4 \\\\ 2/3 \\end{array}\\right] + c_{2}\\left[\\begin{array}{c} 1 \\\\ -1 \\end{array}\\right] = \\left[\\begin{array}{c} 1 \\\\ 0 \\end{array}\\right]\\\\ \n\\left[ \\begin{array}{cc} 1/4 & 1 \\\\ 2/3 & -1 \\end{array}\\right]\\left[\\begin{array}{c} c_{1} \\\\ c_{2} \\end{array}\\right] = \\left[\\begin{array}{c} 1 \\\\ 0 \\end{array}\\right] \\\\\n\\left[ \\begin{array}{cc} 1/4 & 1 \\\\ 11/12 & 0 \\end{array}\\right]\\left[\\begin{array}{c} c_{1} \\\\ c_{2} \\end{array}\\right] = \\left[\\begin{array}{c} 1 \\\\ 1 \\end{array}\\right] \\\\\n\\left[ \\begin{array}{cc} 0 & 1 \\\\ 1 & 0 \\end{array}\\right]\\left[\\begin{array}{c} c_{1} \\\\ c_{2} \\end{array}\\right] = \\left[\\begin{array}{c} 8/11 \\\\ 12/11 \\end{array}\\right]\\end{align*} Thus $c_{1} = 12/11$, $c_{2} = 8/11$.\n\nNow that we know the values of the constants, we will exploit the\nrelationship\n\n\\begin{align*}P\\mathbf{v}_{k} = \\lambda_{k}\\mathbf{v}_{k} \\quad \\rightarrow \\quad P^{n}\\mathbf{v}_{k} = \\lambda_{k}^{n}\\mathbf{v}_{k},\\end{align*}\n\nwhich holds for eigenvectors \\textbf{v}\\textsubscript{\\emph{k}}.\n\nUsing our answer from part b), we have the following\n\n\\begin{align*}\nP^{n}\\left[\\begin{array}{c} 1 \\\\ 0 \\end{array}\\right] &= P^{n}(c_{1}\\mathbf{v}_{1} + c_{2}\\mathbf{v}_{2})\\\\  &= c_{1}\\lambda_{1}^{n}\\mathbf{v}_{1} + c_{2}\\lambda_{2}^{n}\\mathbf{v}_{2} \\\\\n&= \\frac{12}{11}\\left[\\begin{array}{c} 1/4 \\\\ 2/3 \\end{array}\\right] + \\frac{8}{11}\\left(\\frac{1}{12}\\right)^{n}\\left[\\begin{array}{c} 1 \\\\ -1 \\end{array}\\right] \\\\\n&= \\frac{1}{11}\\left[\\begin{array}{c} 3 + 8\\left(\\frac{1}{12}\\right)^{n} \\\\ 8 - 8\\left(\\frac{1}{12}\\right)^{n} \\end{array}\\right]\\end{align*}\n\nTherefore, assuming that the walker starts in state 1, the probability\nthat the walker is in state 1 after $n$ steps is\n\n\\begin{align*}\\frac{1}{11}\\left( 3 + 8\\left(\\frac{1}{12}\\right)^{n} \\right)\\end{align*}", 
        "You can also solve this directly when you diagonalize \\emph{P}:\n\n\\begin{align*}P = M D M^{-1}\\end{align*}\n\nwhere \\emph{M} is the matrix with the eigenvectors of \\emph{P} as its\ncolumns, and \\emph{D} is a diagonal matrix with the corresponding\neigenvalues on its diagonal. The catch is that then\n\n\\begin{align*}P^n = MD^n M^{-1}\\end{align*}\n\nand that powers of a diagonal matrix \\emph{D} are very easy to\ncalculate.\n\nSo let's do the work: Recall that and an eigenvector to the eigenvalue\n\\textbf{1} is\n$v = \\left[\\begin{array}{c} 1/4 \\\\ 2/3 \\end{array}\\right]$, and an\neigenvector to the eigenvalue \\textbf{1/12} is\n$w = \\left[\\begin{array}{c} 1 \\\\ -1 \\end{array}\\right]$. Possible\nchoices of \\emph{M} and \\emph{D} are therefore\n\n\\begin{align*}\nM &= \\left[\\begin{array}{cc} 1/4 & 1 \\\\ 2/3 & -1 \\end{array}\\right] \\quad \\text{and} \\quad D &= \\left[\\begin{array}{cc} 1 & 0 \\\\ 0 & 1/12 \\end{array}\\right] \\\\\n\\text{or} \\\\\nM &= \\left[\\begin{array}{cc} 1 & 1/4 \\\\ -1 & 2/3 \\end{array}\\right] \\quad \\text{and} \\quad D &= \\left[\\begin{array}{cc} 1/12 & 0 \\\\ 0 & 1 \\end{array}\\right] \\end{align*}\n\nMultiplying any column of \\emph{M} (but not of \\emph{D}) by a non-zero\nconstant is also possible. We choose the former matrices \\emph{M} and\n\\emph{D}.\n\nNext step is to find \\emph{M}\\textsuperscript{\\emph{-1}}, which is\nparticularly easy for a \\emph{2}x\\emph{2} matrix since we use the\nformula\n\n\\begin{align*}\\left(\\left[\\begin{array}{cc} a & b \\\\ c & d \\end{array}\\right]\\right)^{-1} = \\frac1{ad-bc} \\left[\\begin{array}{cc} d & -b \\\\ -c & a \\end{array}\\right].\\end{align*}\n\nTherefore, we obtain\n\n\\begin{align*}\nP &= MDM^{-1} \\\\\n\\left[\\begin{array}{cc} 1/3 & 1/4 \\\\ 2/3 & 3/4\\end{array}\\right] &= \\left[\\begin{array}{cc} 1/4 & 1 \\\\ 2/3 & -1 \\end{array}\\right] \\left[\\begin{array}{cc} 1 & 0 \\\\ 0 & 1/12 \\end{array}\\right] \\frac{-12}{11} \\left[\\begin{array}{cc} -1 & -1 \\\\ -2/3 & 1/4 \\end{array}\\right]\\end{align*}\n\nTherefore\n\n\\begin{align*}\nP^n &= MD^nM^{-1} \\\\\n&= \\left[\\begin{array}{cc} 1/4 & 1 \\\\ 2/3 & -1 \\end{array}\\right] \\left[\\begin{array}{cc} 1^n & 0 \\\\ 0 & (1/12)^n \\end{array}\\right] \\frac{-12}{11} \\left[\\begin{array}{cc} -1 & -1 \\\\ -2/3 & 1/4 \\end{array}\\right] \\\\ \\\\\n&= \\frac{-12}{11} \\left[\\begin{array}{cc} -\\frac14 - \\frac23(\\frac1{12})^n & -\\frac14+\\frac14(\\frac1{12})^n \\\\ -\\frac23+\\frac23(\\frac1{12})^n & -\\frac23 - \\frac14(\\frac1{12})^n \\end{array}\\right] \\\\ \\\\\n&= \\frac1{11} \\left[\\begin{array}{cc} 3+ 8(\\frac1{12})^n & 3-3(\\frac1{12})^n \\\\ 8-8(\\frac1{12})^n & 8+3(\\frac1{12})^n \\end{array}\\right]\\end{align*}\n\nHence, finally, we can conclude that\n\n\\begin{align*}\nP^n \\left[\\begin{array}{c} 1 \\\\ 0 \\end{array}\\right] &= \\frac1{11} \\left[\\begin{array}{cc} 3+ 8(\\frac1{12})^n & 3-3(\\frac1{12})^n \\\\ 8-8(\\frac1{12})^n & 8+3(\\frac1{12})^n \\end{array}\\right] \\left[\\begin{array}{c} 1 \\\\ 0 \\end{array}\\right] \\\\\n&= \\frac1{11} \\left[\\begin{array}{c} 3+ 8(\\frac1{12})^n \\\\ 8-8(\\frac1{12})^n \\end{array}\\right]\\end{align*}\n\nwhich means that the probability of being at stage \\emph{1} after\n\\emph{n} steps is\n\n\\begin{align*}\\frac1{11} \\left(3+8\\left(\\frac1{12}\\right)^n\\right)\\end{align*}"
    ], 
    "hints": [
        "Use the information about the eigenvalues and eigenvectors of \\emph{P}\nto calculate the \\emph{n}-th power \\emph{P}\\textsuperscript{\\emph{n}} of\n\\emph{P}."
    ]
}