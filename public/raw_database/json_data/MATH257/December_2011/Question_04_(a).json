{
    "term": "December", 
    "question": "Question_04_(a)", 
    "course": "MATH257", 
    "statement": "Consider the following problem for the heat equation with a\ntime-dependent source term, and mixed boundary conditions:\n\n$u_t = u_{xx} + t, \\quad 0 < x < 1,\\ t > 0,$\n\n$u_x(0,t) = 0, \\quad u(1,t) = 0, \\quad u(x,0) = 1.$\n\nBriefly describe how you would use the method of finite differences to\nfind an approximate solution to this problem. Use the notation\n$u_n^k \\approx u(x_n,t_k)$ to denote the values of $u$ on the finite\ndifference mesh, and include how you propose to incorporate the boundary\nand initial conditions. ''In case it is useful, the Taylor expansion\nformula is\n$f(x+\\Delta x) = f(x) + f'(x)\\Delta x + \\frac12 f''(x)(\\Delta x)^2 + O((\\Delta x)^3).$", 
    "year": 2011, 
    "sols": [
        "By the Taylor series expansion,\n\n\\begin{align*}u(x,t + \\Delta t) = u(x,t) + \\Delta t \\; u_t(x,t) + O((\\Delta t)^2)  . \\,\\end{align*}\nIf we isolate $u_t(x,t)$ in the above, we get that\n\n\\begin{align*}u_t(x,t) = \\frac{u(x,t+ \\Delta t) - u(x,t)}{\\Delta t}  .\\end{align*}\n\nSimilarly, by Taylor series expansion, we have\n\n\\begin{align*}u(x + \\Delta x, t) = u(x,t) + \\Delta x \\; u_x(x,t) + \\frac{(\\Delta x)^2}{2!} u_{xx}(x,t) + \\frac{(\\Delta x)^3}{3!} u_{xxx}(x,t) + O((\\Delta x)^4)\\end{align*}\nand\n\n\\begin{align*}u(x - \\Delta x, t) = u(x,t) - \\Delta x \\; u_x(x,t) + \\frac{(\\Delta x)^2}{2!} u_{xx}(x,t) - \\frac{(\\Delta x)^3}{3!} u_{xxx}(x,t) + O((\\Delta x)^4)  .\\end{align*}\nIf we add the two equations above together, we get that\n\n\\begin{align*}u(x + \\Delta x, t) + u(x - \\Delta x, t) = 2 u(x,t) + (\\Delta x)^2 u_{xx}(x,t) + O((\\Delta x)^4)  . \\,\\end{align*}\nIf we isolate $u_{xx}(x,t)$ in the above, we get that\n\n\\begin{align*}u_{xx}(x,t) = \\frac{ u(x + \\Delta x, t) - 2 u(x,t) + u(x - \\Delta x, t)}{(\\Delta x)^2} + O((\\Delta x)^2) .\\end{align*}\n\nFrom these, we see that we can approximate $u_t(x,t)$ by\n\n\\begin{align*}u_t(x,t) \\approx  \\frac{u(x,t+ \\Delta t) - u(x,t)}{\\Delta t}\\end{align*} and\n$u_{xx}(x,t)$ by\n\n\\begin{align*}u_{xx}(x,t) \\approx  \\frac{ u(x + \\Delta x, t) - 2 u(x,t) + u(x - \\Delta x, t)}{(\\Delta x)^2}  .\\end{align*}\n\nHence, we can approximate the equation\n\n\\begin{align*}u_t = u_xx + t  \\,\\end{align*} by\n\n\\begin{align*}\\frac{u(x,t+ \\Delta t) - u(x,t)}{\\Delta t} = \\frac{ u(x + \\Delta x, t) - 2 u(x,t) + u(x - \\Delta x, t)}{(\\Delta x)^2} + t .\\end{align*}\nIf we isolate $u(x,t+ \\Delta t)$ in the above, we get that\n\n\\begin{align*}u(x,t+ \\Delta t) = u(x,t) + \\frac{\\Delta t}{(\\Delta x)^2}[u(x + \\Delta x, t) - 2 u(x,t) + u(x - \\Delta x, t)] + t \\Delta t  . \\;\\;\\; \\text{(1)}\\end{align*}\n\nNext we will put $N+1$ mesh points in the interval $[0,1]$. Let\n\n\\begin{align*}x_n = n \\Delta x \\;\\; \\text{for} \\;\\; n = 0,1,2, \\cdots, N\\end{align*} where\n\n\\begin{align*}\\Delta x = \\frac{1}{N} .\\end{align*} Here, $x_0 = 0$ and $x_N = 1$. Similarly,\nwe will let the mesh points in $t$ be\n\n\\begin{align*}t_k = k \\Delta t \\;\\; \\text{for} \\;\\; k = 0, 1, 2, \\cdots\\end{align*} for some\nsmall time step $\\Delta t$.\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=.5\\textwidth]{Math_Exam_Resources_Courses_MATH257_December_2011_Question_4_(a)_4a_2.png}\n\\caption{Math\\_Exam\\_Resources\\_Courses\\_MATH257\\_December\\_2011\\_Question\\_4\\_(a)\\_4a\\_2.png}\n\\end{figure}\n\nAt $x = x_n$ and $t = t_k$, equation (1) becomes\n\n\\begin{align*}u(x_n,t_{k+1}) = u(x_n,t_k) + \\frac{\\Delta t}{(\\Delta x)^2}[u(x_{n+1}, t_k) - 2 u(x_n,t_k) + u(x_{n-1}, t_k)] + t_k \\Delta t  .\\end{align*}\nTo get the above, we used\n\n\\begin{align*}t+ \\Delta t = t_{k+1} , x + \\Delta x = x_{n+1} \\;\\; \\text{and} \\;\\; x - \\Delta x = x_{n-1}.\\end{align*}\nUsing the notation $u_n^k \\approx u(x_n, t_k)$, we can write the above\nas\n\n\\begin{align*}u_n^{k+1} = u_n^k + \\frac{\\Delta t}{(\\Delta x)^2}[u_{n+1}^k - 2 u_n^k + u_{n-1}^k] + t_k \\Delta t .  \\;\\; (2)\\end{align*}\n\nIf we look at the above equation, we see that for each fixed $k$, it\ngives us a scheme to compute $u_n^{k+1}$ once $u_n^k$ is known for\n$n =0 ,1, 2, \\cdots, N$.\n\\includegraphics[width=.5\\textwidth]{Math_Exam_Resources_Courses_MATH257_December_2011_Question_4_(a)_q4a_1.png}\\\\For\nthe initial condition $u(x,0) = 0$, we set\n\n\\begin{align*}u_n^0 = 0 \\;\\; \\text{for} \\;\\; n = 0,1,2,\\cdots, N .\\end{align*} For the\nboundary condition $u(1,t) = 0$, we set\n\n\\begin{align*}u_N^k = 0 \\;\\; \\text{for} \\;\\; k = 1,2,3, \\cdots  .\\end{align*} Now, for the\nboundary condition $u_x(0,t) = 0$, there is more than one way to handle\nthat. One possible way is to set\n\n\\begin{align*}\\frac{u(0,t) - u(0 - \\Delta x,t)}{\\Delta x} = 0\\end{align*} which implies\n\n\\begin{align*}u(0,t) = u(-\\Delta x, t) \\,\\end{align*} If we allow an extra mesh point to the\nleft of $x_0$, the above gives\n\n\\begin{align*}u_0^k = u_{-1}^k .\\end{align*} Hence, for $n =0$, equation (2) can be rewritten\nas\n\n\\begin{align*}\nu_0^{k+1} &= u_0^k + \\frac{\\Delta t}{(\\Delta x)^2}[u_{1}^k - 2 u_0^k + u_{-1}^k] + t_k \\Delta t  \\\\\n&=  u_0^k + \\frac{\\Delta t}{(\\Delta x)^2}[u_{1}^k - u_0^k] + t_k \\Delta t . \\end{align*}\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=.5\\textwidth]{Math_Exam_Resources_Courses_MATH257_December_2011_Question_4_(a)_q4a_3.png}\n\\caption{Math\\_Exam\\_Resources\\_Courses\\_MATH257\\_December\\_2011\\_Question\\_4\\_(a)\\_q4a\\_3.png}\n\\end{figure}\n\nReferring to the diagram above, to find an approximate solution to this\nproblem, we first set the initial conditions\n\n\\begin{align*}u_n^0 = 0 \\;\\; \\text{for} \\;\\;  n = 0, 1, 2, \\cdots, N\\end{align*} and the\nboundary condition\n\n\\begin{align*}u_N^k = 0 \\;\\; \\text{for}  \\;\\; k = 1, 2, 3, \\cdots\\end{align*} Then, we compute\n$u_n^1$ from $u_n^0$ by\n\n\\begin{align*}u_0^1 =  u_0^0 + \\frac{\\Delta t}{(\\Delta x)^2}[u_{1}^0 - u_0^0] + t_0 \\Delta t\\end{align*}\nand\n\n\\begin{align*}u_n^{1} = u_n^0 + \\frac{\\Delta t}{(\\Delta x)^2}[u_{n+1}^0 - 2 u_n^0 + u_{n-1}^0] + t_0 \\Delta t \\;\\; \\text{for} \\;\\; n = 1, 2, 3, \\cdots, N.\\end{align*}\nOnce we have $u_n^1$, we can iterate the process to find\n$u_n^2, u_n^3, \\cdots$"
    ], 
    "hints": [
        "For $\\Delta t$ small, Taylor expansion of $u(x,t+\\Delta t)$ with respect\nto time variable about \\emph{(x,t)} gives\n\n\\begin{align*}~u(x,t+\\Delta t) = u(x,t) + u_{t}(x,t) \\Delta t + O((\\Delta t)^2)\\end{align*}\n\nThis reminds us of the forward difference approximation for the time\nderivative:\n\n\\begin{align*}u_{t}(x,t) \\approx \\frac{u(x,t+\\Delta t)-u(x,t)}{\\Delta t}\\end{align*}\n\nwhich has error of $O(\\Delta t)$, i.e. first order accurate.\n\nSimilarly, for $\\Delta x$ small, Taylor expansion of $u(x+\\Delta x, t)$\nwith respect to the space variable about \\emph{(x,t)} gives\n\n\\begin{align*}u(x+\\Delta x, t) = u(x,t) + u_{x}(x,t) \\Delta x + \\frac{1}{2!} u_{xx}(x,t) (\\Delta x)^2 + \\frac{1}{3!} u_{xxx}(x,t) (\\Delta x)^2 O((\\Delta x)^4)\\end{align*}\n\nand\n\n\\begin{align*}u(x-\\Delta x, t) = u(x,t) - u_{x}(x,t) \\Delta x + \\frac{1}{2!} u_{xx}(x,t) (\\Delta x)^2 - \\frac{1}{3!} u_{xxx}(x,t) (\\Delta x)^3+ O((\\Delta x)^4)\\end{align*}\n\nThis reminds us of the centered difference approximation for the second\nspace derivative:\n\n\\begin{align*}u_{xx}(x,t) \\approx \\frac{u(x+\\Delta x,t)-2u(x,t)+u(x-\\Delta x,t)}{\\Delta x^2}\\end{align*}\n\nwhich has an error of $O(\\Delta x^2)$, i.e. second order accurate.\n\nPutting these back to the equation gives\n\n\\begin{align*}\\frac{u(x,t+\\Delta t)-u(x,t)}{\\Delta t} = \\frac{u(x+\\Delta x,t)-2u(x,t)+u(x-\\Delta x,t)}{\\Delta x^2} \\quad + \\quad t \\quad + \\quad O(\\Delta t, \\Delta x^2)\\end{align*}\n\nWith uniform time step $~\\Delta t = t_{max} / K$ and mesh spacing\n$~\\Delta x=1/N$, let $~ x_n = n \\Delta x$, where $n=0,1,2,...,N$; and\n$~ t_k = k \\Delta t$, where $k=0,1,2,...,K$; and\n$u_{n}^{k} = u(x_n,t_k)$.\n\nPlug these mesh points onto the above gives a linear system with\nvariables $u_{n}^{k}$. (Note that some of these values are not unknown,\nbut can be calculated directly using the boundary conditions.)\n\nWork out an equation for a fixed \\emph{n} and \\emph{k}, showing\n$u_n^{k+1}$ in terms of values from the previous time step, i.e.\n$u_n^k, u_{n-1}^k, u_{n+1}^k$.\n\nThen consider what should $u_{n}^{k}$ be when $k=0$ and when $n=0,N$\n\nBe reminded that the left Neumann condition\n\n\\begin{align*}~ u_x(0,t) = 0\\end{align*}\n\nis tricky in that you need again to use the centered difference formula\nfor first derivative to incorporate that. You might want to add a\n``fictional'' point to do that."
    ]
}